from ciphey.iface import Config
from ciphey.basemods.Crackers.xorcrypt import XorCrypt

cfg = Config().library_default().set_verbosity(3).complete_config()

ctext = [
    0x0A,
    0x1D,
    0x54,
    0x0E,
    0x02,
    0x1A,
    0x54,
    0x0D,
    0x0B,
    0x0C,
    0x54,
    0x1D,
    0x0C,
    0x1F,
    0x11,
    0x0B,
    0x43,
    0x1B,
    0x1B,
    0x18,
    0x07,
    0x49,
    0x00,
    0x11,
    0x02,
    0x1D,
    0x54,
    0x15,
    0x02,
    0x10,
    0x58,
    0x59,
    0x0C,
    0x07,
    0x54,
    0x18,
    0x43,
    0x0F,
    0x06,
    0x10,
    0x07,
    0x08,
    0x0D,
    0x59,
    0x0D,
    0x00,
    0x13,
    0x11,
    0x17,
    0x49,
    0x18,
    0x18,
    0x17,
    0x0C,
    0x54,
    0x10,
    0x0D,
    0x49,
    0x1A,
    0x16,
    0x15,
    0x0C,
    0x19,
    0x1B,
    0x06,
    0x1B,
    0x58,
    0x59,
    0x01,
    0x0C,
    0x12,
    0x16,
    0x11,
    0x0C,
    0x54,
    0x0D,
    0x0B,
    0x0C,
    0x54,
    0x1F,
    0x0A,
    0x1B,
    0x07,
    0x0D,
    0x43,
    0x06,
    0x12,
    0x59,
    0x17,
    0x01,
    0x11,
    0x59,
    0x13,
    0x0C,
    0x06,
    0x0A,
    0x0C,
    0x07,
    0x07,
    0x59,
    0x14,
    0x00,
    0x00,
    0x11,
    0x43,
    0x1E,
    0x1C,
    0x16,
    0x0E,
    0x49,
    0x00,
    0x11,
    0x0A,
    0x1A,
    0x54,
    0x11,
    0x0A,
    0x1A,
    0x00,
    0x16,
    0x11,
    0x10,
    0x54,
    0x11,
    0x02,
    0x1A,
    0x54,
    0x1B,
    0x16,
    0x1A,
    0x1D,
    0x17,
    0x06,
    0x1A,
    0x07,
    0x57,
]

ctext = bytes(ctext)

print(ctext)

cfg.cache.mark_ctext(ctext)
cfg.cache.get_or_update(ctext, 0, lambda: 1)

res = XorCrypt(cfg).attemptCrack(ctext)

print(res)
